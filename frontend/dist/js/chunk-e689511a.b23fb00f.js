(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e689511a"],{"0bce":function(t,e,a){"use strict";var i=a("4291"),r=a.n(i);r.a},"13d0":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t.showMapVisible?t._e():a("div",[a("div",{staticClass:"header"},[a("b-button",{staticClass:"checkout",attrs:{id:"backToBasket",variant:"outline-primary",disabled:!t.visibleButton},on:{click:t.toBasket}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"chevron-left"}}),t._v(" Вернуться в корзину ")],1),a("div",{staticClass:"title checkout"},[t._v(" Оформление заказа")])],1),a("div",[a("b-table",{attrs:{striped:"",hover:"",items:t.allProducts,fields:t.fields}})],1),a("hr"),a("div",{staticClass:"totalPrice"},[t._m(0),a("div",{staticClass:"price",domProps:{textContent:t._s(t.getTotalPrice+" руб.")}})]),a("hr")]),a("Farmacy",{attrs:{visibleButton:!t.visibleButton,visibleAfterOrder:t.visibleButton},on:{choiceFarmacy:t.choiceFarmacy,choiceFarmacyFromMap:t.choiceFarmacyFromMap,showMap:t.showMap,choiceFarmacyBack:t.choiceFarmacyBack}}),t.stateChoice?a("Login",{attrs:{pharmacyForOrder:t.pharmacyForOrder},on:{visibleAfterOrder:t.visibleAfterOrder}}):t._e()],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("i",[t._v("Всего к оплате:")])])}],s=a("5530"),n=a("f1dd"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"choice"},[a("div",{staticClass:"choiceChild"},[a("b-dropdown",{staticClass:"m-2",class:{isActive:!t.state},attrs:{split:"","split-variant":"outline-info",text:"Выберите город",variant:"info"}},t._l(t.cities,(function(e,i){return a("b-dropdown-item",{key:i,on:{click:function(e){return t.getCity(i)}}},[t._v(t._s(e)+" ")])})),1)],1),t.choiceCity?a("div",{staticClass:"choiceChild",class:{isActive:!t.state}},[t.mapClose?a("div",[a("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.showOnMap()}}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"map-pin"}}),a("i",[t._v(" Посмотреть на карте")])],1)],1):a("div",[a("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.showOnMap()}}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"map-pin"}}),a("i",[t._v("Закрыть карту")])],1)],1)]):t._e()]),t._l(t.filteredCity,(function(e,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.state,expression:"state"}],key:i,staticClass:"filteredCity",class:{isActive:t.mapVisible}},t._l(e,(function(e,i){return a("div",{key:i,staticClass:"row city"},[a("div",{staticClass:"pharmacyContent",class:{mapVisible:!t.mapVisible}},[a("div",{staticClass:"content"},[t._v(" "+t._s(e.pharmacy_name)+", ул. "+t._s(e.street)+", "+t._s(e.house)+", тел. "+t._s(e.phone)+" ")]),a("div",{staticClass:"pharmacyChoice"},[a("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.choiceFarmacy(i)}}},[t._v("Выберите аптеку")])],1)])])})),0)})),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.state,expression:"!state"}],staticClass:"filteredCity"},[a("div",{staticClass:"row city"},[a("div",{staticClass:"pharmacyContent"},[a("div",{staticClass:"content"},[t._v(" "+t._s(t.pharmacyChoice.pharmacy_name)+", ул. "+t._s(t.pharmacyChoice.street)+", "+t._s(t.pharmacyChoice.house)+", тел. "+t._s(t.pharmacyChoice.phone)+" ")]),a("div",{staticClass:"buttonGroup"},[a("div",{staticClass:"pharmacyChoice"},[a("b-button",{attrs:{variant:"outline-primary",disabled:t.visibleButton},on:{click:function(e){return t.choiceFarmacyBack()}}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"check"}})],1)],1),t.mapClose?a("div",{staticClass:"itemMap"},[a("b-button",{attrs:{variant:"outline-primary",disabled:t.visibleButton},on:{click:function(e){return t.showOnMap("se")}}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"map-pin"}}),a("i",[t._v(" Посмотреть на карте")])],1)],1):a("div",{staticClass:"itemMap",class:{isActive:!t.mapVisible}},[a("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.showOnMap("cl")}}},[a("custom-icon",{staticClass:"custom-icon",attrs:{name:"map-pin"}}),a("i",[t._v(" Закрыть карту")])],1)],1)])])])]),t.mapVisible?a("Map",{attrs:{locations:t.state?t.selectedLocationsAll:t.selectedLocations},on:{clickMarker:t.clickMarker}}):t._e()],2)},o=[],l=(a("99af"),a("4de4"),a("4160"),a("a9e3"),a("ac1f"),a("466d"),a("159b"),a("96cf"),a("1da1")),u=a("a0b9"),m=a("b414"),p=a("a30f"),h=a.n(p),d={props:{visibleButton:{type:Boolean},visibleAfterOrder:{type:Boolean}},components:{customIcon:n["a"],Map:u["default"]},data:function(){return{firstName:"",lastName:"",phoneOrder:"",payloads:[],cities:[],state:!0,stateMap:!1,class:"",pharmacyChoice:{},pharmacyChoiceAll:[],filteredCity:[],count:0,mapVisible:!1,listVisible:!1,mapClose:!0,locations:[]}},computed:{selectedLocations:function(){var t=this;return this.pharmacyChoice.pharmacyId?this.locations.filter((function(e){return e.position.pharmacyId===t.pharmacyChoice.pharmacyId})):[]},selectedLocationsAll:function(){var t=this,e=[];return this.locations.forEach((function(a){t.pharmacyChoiceAll.forEach((function(t){Number(a.position.pharmacyId)===t.pharmacyId&&e.push(a)}))})),e},choiceCity:function(){if(0!==this.pharmacyChoiceAll.length)return!0}},methods:{getPayload:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m["a"]("pharmacy");case 2:for(s in a=e.sent,t.payloads=a.pharmacyes,t.payloads.forEach((function(e){var a={};a["lat"]=e.latitude,a["lng"]=e.longitude,a["pharmacyId"]=e.pharmacyId;var i={position:a};t.locations.push(i)})),i=h()(t.payloads,"city"),r=[],i)r.push(s);t.cities=t.cities.concat(r).sort();case 9:case"end":return e.stop()}}),e)})))()},getCity:function(t){this.filteredCity=[];var e=this.cities[t],a=this.payloads.filter((function(t){return t.city.match(e)}));this.filteredCity.push(a),this.pharmacyChoiceAll=a},choiceFarmacy:function(t){var e=this;this.state=!this.state,this.filteredCity.forEach((function(a){e.pharmacyChoice=a[t]})),this.$emit("choiceFarmacy",this.pharmacyChoice)},choiceFarmacyBack:function(){this.state=!this.state,this.mapClose=!this.mapClose,this.$emit("choiceFarmacyBack",!1)},showOnMap:function(t){t="se"===t||"cl"!=t&&!this.mapVisible,this.mapVisible=!this.mapVisible,this.mapClose=!this.mapClose,this.$emit("showMap",t)},clickMarker:function(t){var e=t.lat(),a=t.lng(),i={};this.payloads.forEach((function(t){t.latitude==e&&t.longitude==a&&(i=t)})),this.pharmacyChoice=i,this.state=!this.state,this.mapVisible=!this.mapVisible,this.$emit("choiceFarmacyFromMap",i)}},mounted:function(){this.getPayload()}},f=d,v=(a("0bce"),a("2877")),b=Object(v["a"])(f,c,o,!1,null,"7f788b3f",null),y=b.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contentLogin"},[a("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var i=e.passes;return[a("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),i(t.onSubmit)}}},[t.visible?a("b-form-group",{staticClass:"mb-0",attrs:{"label-cols-lg":"3",label:"Контактные данные","label-size":"lg","label-class":"font-weight-bold pt-0"}},[a("validation-provider",{attrs:{name:"Name",rules:{required:!0,min:3}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-form-group",{attrs:{id:"example-input-group-1",label:"Имя:","label-cols-sm":"3","label-align-sm":"right","label-for":"example-input-1"}},[a("b-form-input",{attrs:{id:"example-input-1",name:"example-input-1",state:t.getValidationState(e),"aria-describedby":"input-1-live-feedback"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),a("b-form-invalid-feedback",{attrs:{id:"input-1-live-feedback"}},[t._v(t._s(e.errors[0])+" ")])],1)]}}],null,!0)}),a("validation-provider",{attrs:{name:"SurName",rules:{required:!0,min:3}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-form-group",{attrs:{id:"example-input-group-2","label-cols-sm":"3",label:"Фамилия:","label-align-sm":"right","label-for":"example-input-2"}},[a("b-form-input",{attrs:{id:"example-input-2",name:"example-input-2",state:t.getValidationState(e),"aria-describedby":"input-1-live-feedback"},model:{value:t.form.surname,callback:function(e){t.$set(t.form,"surname",e)},expression:"form.surname"}}),a("b-form-invalid-feedback",{attrs:{id:"input-1-live-feedback"}},[t._v(t._s(e.errors[0])+" ")])],1)]}}],null,!0)}),a("validation-provider",{attrs:{name:"Phone",rules:{required:!0,min:15}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-form-group",{attrs:{id:"example-input-group-3","label-cols-sm":"3",label:"Номер телефона:","label-align-sm":"right","label-for":"example-input-2"}},[a("b-form-input",{attrs:{id:"example-input-3",name:"example-input-3",state:t.getValidationState(e),"aria-describedby":"input-1-live-feedback"},on:{input:t.acceptNumber},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}}),a("b-form-invalid-feedback",{attrs:{id:"input-1-live-feedback"}},[t._v(t._s(e.errors[0])+" ")])],1)]}}],null,!0)})],1):t._e(),t.visible?a("div",{staticClass:"buttonLogin"},[a("b-button",{attrs:{type:"submit",variant:"success"}},[t._v("Заказать")])],1):t._e()],1)]}}])}),t.visible?t._e():a("div",{staticClass:"orderSuccessful"},[a("p",[t._v("Ваша заявка принята! Спасибо за покупку!")]),a("b-button",{attrs:{variant:"outline-primary"},on:{click:t.backToMain}},[t._v("Вернуться на главную страницу")])],1)],1)},g=[],_=(a("5319"),a("2f62")),k={name:"Login",props:{pharmacyForOrder:{type:Object}},data:function(){return{form:{name:null,surname:null,phone:null},visible:!0}},computed:Object(s["a"])({},Object(_["b"])(["allProducts"]),{},Object(_["b"])(["orderProductList"])),methods:{getValidationState:function(t){var e=t.dirty,a=t.validated,i=t.valid,r=void 0===i?null:i;return e||a?r:null},onSubmit:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.form.order=t.orderProductList,t.form.pharmacyId=t.pharmacyForOrder.pharmacyId,e.next=4,m["b"]("order",t.form);case 4:a=e.sent,a&&(t.visible=!t.visible),t.form={name:null,surname:null,phone:null},t.$nextTick((function(){t.$refs.observer.reset()})),t.$emit("visibleAfterOrder",t.visible);case 9:case"end":return e.stop()}}),e)})))()},acceptNumber:function(){var t=this.form.phone.replace(/\D/g,"").match(/(\d{0,3})(\d{0,3})(\d{0,2})(\d{0,2})/);this.form.phone=t[2]?"("+t[1]+") "+t[2]+(t[3]?"-"+t[3]+"-"+t[4]:""):t[1]},backToMain:function(){this.$router.go(-2),this.$store.commit("clearStore")}}},w=k,x=(a("ade1"),Object(v["a"])(w,C,g,!1,null,"19202d79",null)),O=x.exports,M={name:"Checkout",components:{customIcon:n["a"],Farmacy:y,Login:O},data:function(){return{fields:{title:"Наименование",manufacturer:"Производитель",price:"Цена",quantity:"Количество",valueProduct:"Сумма"},pharmacyForOrder:Object,stateChoice:!1,showMapVisible:!1,visibleButton:!0}},computed:Object(s["a"])({},Object(_["b"])(["allProducts"]),{},Object(_["b"])(["getTotalPrice"])),methods:{toBasket:function(){this.$router.go(-1)},choiceFarmacy:function(t){this.pharmacyForOrder=t,this.stateChoice=!0},choiceFarmacyBack:function(t){this.stateChoice=t},visibleAfterOrder:function(t){this.visibleButton=t},showMap:function(t){this.showMapVisible=t},choiceFarmacyFromMap:function(t){this.pharmacyForOrder=t,this.stateChoice=!0,this.showMapVisible=!this.showMapVisible}}},F=M,$=(a("a423"),Object(v["a"])(F,i,r,!1,null,"cbab20a0",null));e["default"]=$.exports},"2b7b":function(t,e,a){},4291:function(t,e,a){},5196:function(t,e,a){},5319:function(t,e,a){"use strict";var i=a("d784"),r=a("825a"),s=a("7b0b"),n=a("50c4"),c=a("a691"),o=a("1d80"),l=a("8aa5"),u=a("14c3"),m=Math.max,p=Math.min,h=Math.floor,d=/\$([$&'`]|\d\d?|<[^>]*>)/g,f=/\$([$&'`]|\d\d?)/g,v=function(t){return void 0===t?t:String(t)};i("replace",2,(function(t,e,a,i){var b=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=i.REPLACE_KEEPS_$0,C=b?"$":"$0";return[function(a,i){var r=o(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,r,i):e.call(String(r),a,i)},function(t,i){if(!b&&y||"string"===typeof i&&-1===i.indexOf(C)){var s=a(e,t,this,i);if(s.done)return s.value}var o=r(t),h=String(this),d="function"===typeof i;d||(i=String(i));var f=o.global;if(f){var _=o.unicode;o.lastIndex=0}var k=[];while(1){var w=u(o,h);if(null===w)break;if(k.push(w),!f)break;var x=String(w[0]);""===x&&(o.lastIndex=l(h,n(o.lastIndex),_))}for(var O="",M=0,F=0;F<k.length;F++){w=k[F];for(var $=String(w[0]),S=m(p(c(w.index),h.length),0),A=[],B=1;B<w.length;B++)A.push(v(w[B]));var E=w.groups;if(d){var V=[$].concat(A,S,h);void 0!==E&&V.push(E);var P=String(i.apply(void 0,V))}else P=g($,h,S,A,E,i);S>=M&&(O+=h.slice(M,S)+P,M=S+$.length)}return O+h.slice(M)}];function g(t,a,i,r,n,c){var o=i+t.length,l=r.length,u=f;return void 0!==n&&(n=s(n),u=d),e.call(c,u,(function(e,s){var c;switch(s.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,i);case"'":return a.slice(o);case"<":c=n[s.slice(1,-1)];break;default:var u=+s;if(0===u)return e;if(u>l){var m=h(u/10);return 0===m?e:m<=l?void 0===r[m-1]?s.charAt(1):r[m-1]+s.charAt(1):e}c=r[u-1]}return void 0===c?"":c}))}}))},a423:function(t,e,a){"use strict";var i=a("5196"),r=a.n(i);r.a},ade1:function(t,e,a){"use strict";var i=a("2b7b"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-e689511a.b23fb00f.js.map